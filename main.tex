\documentclass{article}
\usepackage{graphicx, amsmath, amsfonts, amssymb, hyperref, amsthm, comment, stmaryrd, mathabx}
\usepackage{algorithm2e}
\usepackage{listings}
\usepackage[shortlabels]{enumitem}% Required for inserting images
\theoremstyle{definition}
\newtheorem{thm}{Theorem}[section]
\newtheorem{lem}[thm]{Lemma}
\newtheorem{dfn}[thm]{Definition}
\newtheorem{rmk}[thm]{Remark}
\newtheorem{exm}[thm]{Example}
\usepackage[title]{appendix}

\title{Math 761 Differentiable Manifolds}

\begin{document}

\maketitle

\tableofcontents

\newpage

\section{Topological Manifolds}

Firstly let's recall some basic concepts from topology:

\begin{enumerate}
    \item Let $X$ be a non-empty set. A {\bf topology} is a subset $O$ of its power set $P(X)$, such that $X\in O$, $\emptyset\in O$, $A\subseteq O$ then $\bigcup A\in O$ (here $\bigcup A$ is defined as $\bigcup A=\bigcup_{U\in A}U$), and if $P, Q\in O$ then $P\cap Q\in O$. Elements of $O$ are called {\bf open sets}, their complements are called {\bf closed sets}. $(X, O)$ is called a {\bf topological space}.
    \item Let $(X, O)$ be a topological space, $B\subseteq O$ is called a {\bf basis} of the topology, if for any $U\in O$, $U=\bigcup_{V\in B, V\subseteq U}V$. It is easy to see that a subset $B\subseteq P(X)$ is a basis of some topology, as long as $\bigcup_{V\in B}V=X$, and for any two elements $C, D\in B$, any $x\in C\cap D$, there is some $E\in B$ such that $x\in E\subseteq C\cap D$.
    \item Let $X$ be a non-empty set, $d: X\times X\rightarrow \mathbb{R}_{\geq 0}$ is called a {\bf metric} if $d(a, b)=0$ iff $a=b$, $d(a, b)=d(b, a)$, and $d(a, c)\leq d(a, b)+d(b, c)$. $(X, d)$ is called a {\bf metric space}. It is easy to see that a metric on $X$ would induce a topology $O_d$ which is generated by basis 
    \[B_d=\{\{y\in X: d(x, y)<r\}: r\in\mathbb{R}_{>0}, x\in X\}\] 
    \item Let $X$ be a subset of $\mathbb{R}^n$. Unless specified otherwise, we always assume the topology on $X$ is the one obtained via the Euclidean metric 
    \[d((x_1, \dots x_n), (y_1, \dots, y_n))=\sqrt{\sum_{i=1}^n (x_i-y_i)^2}\]
    \item Let $(X, O)$ be a topological space. A {\bf open cover} is a subset of $O$ whose union is $X$. We say $X$ is compact, if any open cover of $X$ has a finite subcover. From analysis classes we know that a subset of $\mathbb{R}^n$ with subspace topology (a subset is open iff it is the intersection with an open set in $\mathbb{R}^n$) iff it is bounded and closed in $\mathbb{R}^n$.
    \item A map $f$ between two topological spaces $(X, O)$ and $(Y, O')$ is called {\bf continuous}, if for any $V\in O'$, $f^{-1}(V)\in O$. If $f: X\rightarrow Y$ is a bijection and both $f$ and $f'$ are continuous, we call $f$ a {\bf homeomorphism}.
\end{enumerate}

\begin{dfn}
    A topological space $M$ is called a {\bf topological manifold}, if it satisfies the following three conditions:
    \begin{itemize}
        \item It is {\bf Hausdorff}: for any $x, y\in M$, $x\not=y$, there are open sets $U$ and $V$ such that $x\in U$, $y\in V$ and $U\cap V=\emptyset$.
        \item It is {\bf Second Countable}: the topology on $M$ has a countable basis $B$.
        \item It is {\bf Locally Euclidean}: for any $x\in M$, there is an open set $U\subseteq M$ such that $x\in U$ and $U$ is homeomorphic to an open disc in $\mathbb{R}^n$. We require the number $n$ to be a constant for all $x\in M$, and it is called the {\bf dimension} of $M$. 
    \end{itemize}
\end{dfn}

\begin{rmk}
    Any topology induced by a metric is Hausdorff. Because if $x\not=y$, we can let $U$ and $V$ be balls centered at $x$ and $y$ respectively and radius $d(x, y)/3$.
\end{rmk}

\begin{exm}
    The following are examples of topological manifolds:
    \begin{enumerate}
        \item $\mathbb{R}^n$, open subsets of $\mathbb{R}^n$.
        \item $\mathbb{S}^n=\{(x_0, \dots, x_n): x_0^2+\dots +x_n^2=1\}$, with subspace topology.
        \item $\{(x_0, \dots, x_n): x_0=\sqrt{x_1^2+\dots+x_n^2}\}$, because it is homeomorphic to $\mathbb{R}^n$ by $(x_0, \dots x_n)\mapsto (x_1, \dots x_n)$.
    \end{enumerate}
\end{exm}

\begin{exm}
    The followings are non-examples of topological manifolds:
    \begin{enumerate}
        \item When $n\geq 1$, $\{(x_0, \dots, x_n): x_0^2=x_1^2+\dots x_n^2\}$. This is Hausdorff and second countable but not locally Euclidean at $(0, \dots, 0)$.
        \item {\bf Line with a Double Point}: Two copies of $\mathbb{R}$ glued together at $(-\infty, 0)\cup (0, \infty)$. More precisely, consider quotient set $M=\mathbb{R}\times \{0, 1\}/\sim$ where $(a, i)\sim (b, j)$ iff $a=b\not=0$ or $a=b=0$, $i=j$, and we say a subset of $M$ is open iff its preimage under the quotient map is open (i.e. take the {\bf quotient topology}) in $\mathbb{R}\times \{0, 1\}$, where the topology is the {\bf product topology} between the Euclidean topology on $\mathbb{R}$ and the {\bf discrete topology} on $\{0, 1\}$. $M$ is second countable, locally Euclidean but not Hausdorff (there are no disjoint neighborhoods of the points $(0, 0)$ and $(0, 1)$).
        \item {\bf Long Line}: We say a set is {\bf well ordered} if it has a linear order $\preceq$ such that any non-empty subset has a minimal element. Let $\omega_1$ be the {\bf first uncountable ordinal}, i.e. an uncountable, well ordered set such that for any $x\in\omega_1$, $\{y\in\omega_1: y\preceq x\}$ is countable. Give the set $\omega_1\times [0, 1)$ the Lexicographical order, then the {\bf long ray} is $\omega_1\times [0, 1)$ with the topology being the {\bf order topology} (the topology generated by the basis consists of all the {\bf open intervals} $(a, b)=\{c\in X: a\precneq c\precneq b\}$). The {\bf Long Line} is defined as two copies of the long ray glued together at the left end points.\\

        The long line is locally Euclidean, because any countable, well ordered set has an order preserving embedding to any open interval in $\mathbb{R}$. It is also Hausdorff which can be verified directly. However it is not second countable: consider the uncountable set of disjoint open subsets $\{((x, 1/3), (x, 2/3)): x\in\omega_1\}$. Let $B$ be any basis of the topology, then each of these disjoint open subset must contain one distinct element from $B$, hence $B$ is uncountable.
    \end{enumerate}
\end{exm}

\begin{dfn}
    A topological space is called {\bf paracompact} if any open cover has a locally finite refinement, i.e. if $(X, O)$ is the topological space, $C\subseteq O$, $\bigcup C=X$, then there is some $C'\subseteq O$, such that:
    \begin{itemize}
        \item For every $U\in C'$, there is some $V\in C$ such that $U\subseteq V$.
        \item $\bigcup C'=X$.
        \item For every $x\in X$, there is some $U_x\in O$, such that $x\in U_x$ and $\{V\in C': V\cap U_x\not=\emptyset\}$ is finite.
    \end{itemize}
\end{dfn}

The main theorem of this section is the following:

\begin{thm}\label{para}
    Any open cover of a topological manifold has a countable, locally finite subcover. In other words, any topological manifold is paracompact.
\end{thm}

\begin{lem}\label{lem1para}
    If $X$ is Hausdorff, then any non-empty compact subset of $X$ is closed.
\end{lem}

\begin{proof}
    Suppose $V\subseteq X$ is compact. For any $b\in X\backslash V$, any $c\in V$, there are open sets $U_c$, $U'_c$ in $X$ such that $c\in U_c$, $b\in U'_c$ and $U_c\cap U'_c=\emptyset$. Hence by compactness there are finitely many points $c_1, \dots c_n\in V$ such that $V\subseteq \bigcup_{i=1}^n U_{c_i}$. Let $W_b=\bigcap_{i=1}^n U'_{c_i}$. It is a finite intersection of open sets, hence is open, and by construction $W_b\subseteq X\backslash V$. Now we have $X\backslash V=\bigcup_{b\in X\backslash V}W_b$ hence must be open, which implies that $V$ is closed.
\end{proof}

\begin{lem}\label{lem12para}
    If $X$ is a second countable topological space, $C$ is an open cover of $X$, then $C$ has a countable subcover.
\end{lem}

\begin{proof}
    Let $B$ be a countable basis of the topology of $X$. For every $U\in B$, if it is contained in some element $V\in C$, pick one such element and denote it as $V_U$ (here we are using the {\bf axiom of countable choice}). Then $\{V_U\}$ is a countable subset of $C$ which is also an open cover of $X$.
\end{proof}

\begin{lem}\label{lem2para}
    If $M$ is a topological manifold, then there is a countable open cover $C$, such that all elements of $C$ are homeomorphic to open discs in $\mathbb{R}^n$, and their closures are homeomorphic to closed discs. 
\end{lem}

\begin{proof}
    For any $p\in M$, let $U_p$ be an open set containing $p$ which is homeomorphic to an open disc, and let $i_p: U_p\rightarrow D$ be this homeomorphism. Let $D_p$ be an open disc centered in $i_p(p)$ which is contained in $D$, then $B_p=i_p^{-1}(D_p)$ is an open subset of $M$ which is homeomorphic to an open disc, and its closure in $U_p$ is homeomorphic to a closed disc. Because closed discs are compact, by Lemma \ref{lem1para}, the closure of $B_p$ in $U_p$ are closed in $M$ as well, hence it is the closure of $B_p$ in $M$. Apply Lemma \ref{lem12para} to the open cover $\{B_p: p\in M\}$ we get the required countable cover of $M$.
\end{proof}

\begin{lem}\label{lem3para}
    If $M$ is a topological manifold, then $M$ has a {\bf exhaustion by compact sets}, i.e. a sequence of compact subsets $X_0\subseteq X_1\subseteq X_2\dots$ such that $X_i$ is contained in the interior of $X_{i+1}$ for all $i\in\mathbb{N}$. 
\end{lem}

\begin{proof}
    Let $C=\{C_0, C_1, C_2, \dots C_n, \dots\}$ be the countable cover of $M$ from Lemma \ref{lem2para}. We build the compact sets $X_i$ inductively as follows:
    \begin{enumerate}
        \item Let $X_0=\overline{C_0}$.
        \item Suppose we already constructed compact set $X_i$. Find finitely many integers $n_1, \dots n_k$ such that $X_i\cup \overline{C_i}\subseteq C_{n_1}\cup\dots \cup C_{n_k}$, and let $X_{i+1}=\bigcup_{j=1}^k \overline{C_{n_j}}$. Repeat this step then we get the exhaustion by compact sets $X_0\subseteq X_1\dots$.
    \end{enumerate}
\end{proof}

\begin{proof}[Proof of Theorem \ref{para}] 
     Let $C$ be a open cover of the topological manifold $M$, $X_0\subseteq X_1\subseteq X_2\subseteq \dots$ a compact exhaustion in Lemma \ref{lem3para}. Let $U_{i, 1}, \dots, U_{i, n_i}$ be finitely many elements in $C$ that cover the compact subset $X_i$, then 
     \[\{U_{0, 1}, \dots, U_{0, n_0}, U_{1, 1}\backslash X_0, \dots, U_{1, n_1}\backslash X_0, \dots, U_{j, k}\backslash X_{j-1}, \dots\}\]
     is a locally finite refinement of $C$.
\end{proof}

\begin{rmk}
    As an exercise, we can further show that any topological manifold is metrizable (the topology is induced by a metric).
\end{rmk}

\newpage

\section{Smooth Structure, Smooth Functions and Smooth Maps}

\begin{dfn}
    Let $M$ be a topological manifold. By a {\bf coordinate chart}, we mean a homeomorphism from an open subset of $M$ to an open subset of $\mathbb{R}^n$. An {\bf smooth atlas} is a set of coordinate charts $\{i_\alpha: U_\alpha\rightarrow V_\alpha\subseteq \mathbb{R}^n\}$, such that
    \begin{itemize}
        \item $\bigcup_\alpha U_\alpha=M$.
        \item If $U_\alpha\cap U_\beta\not=\emptyset$, then 
        \[i_\beta\circ i_\alpha^{-1}: i_\alpha(U_\alpha\cap U_\beta)\rightarrow i_\beta(U_\alpha\cap U_\beta)\]
        is a smooth bijection whose inverse is also smooth (we call such maps {\bf diffeomorphisms}).
        \item A coordinate chart $f$ is said to be {\bf compatible} with a smooth atlas $A$, if $A\cup\{f\}$ is also a smooth atlas.
    \end{itemize}
\end{dfn}

The followings follow immediately from the fact that compositions of diffeomorphisms are diffeomorphisms:

\begin{rmk}
    \begin{itemize}
        \item Let $A$ be a smooth atlas on $M$, $B$ a set of coordinate charts that are compatible with $A$, then $A\cup B$ is a smooth atlas.
        \item Every smooth atlas $A$ is contained in a unique maximal (in the sense of containment) smooth atlas $A^*=\{g: g\text{ is a coordinate chart compatible with }A\}$. Such a maximal smooth atlas is called the {\bf smooth structure} defined by $A$. A topological manifold with a smooth structure is called a {\bf smooth manifold} or a {\bf differentiable manifold}.
        \item Two smooth atlases $A$ and $B$ define the same smooth structure, iff every chart in $A$ is compatible with $B$, iff $A\cup B$ is a smooth atlas.
    \end{itemize}    
\end{rmk}

\begin{rmk}
    We can replace ``smooth'' with other kinds of maps, e.g. $C^1$, $C^2$, real analytic, or affine, and define concepts like ``$C^1$ manifolds'', ``$C^2$ manifolds'', ``real analytic manifolds'' or ``affine manifolds''.
\end{rmk}

\begin{exm}
    On topological manifold $M=\mathbb{R}$, 
    \[A_1=\{i: M\rightarrow\mathbb{R}, x\mapsto x\}\]
    and
    \[A_2=\{i': M\rightarrow \mathbb{R}, x\mapsto x^3\}\]
    are two smooth atlases which define different smooth structures.
\end{exm}

\begin{exm}
\begin{itemize}
    \item If $U$ is an open subset of $\mathbb{R}^n$, the default smooth structure is the one defined by the atlas $\{id: U\rightarrow U\subseteq\mathbb{R}^n\}$.
    \item Let $M=\mathbb{S}^n=\{(x_0, \dots, x_n)\in\mathbb{R}^{n+1}: \sum_ix_i^2=1\}$ be the $n$ dimensional sphere. Let $U_0=\mathbb{S}^n\backslash (1, 0, \dots, 0)$, $U_1=\mathbb{S}^n\backslash (-1, 0, \dots, 0)$, $i_0: U_0\rightarrow\mathbb{R}^n$ be the polar, or stereographic projection map: 
    \[i_0(x_0, \dots, x_n)=({x_1\over 1-x_0}, \dots, {x_n\over 1-x_0})\]
    and $i:1: U_1\rightarrow\mathbb{R}^n$ be 
    \[i_1(x_0, \dots, x_n)=({x_1\over 1+x_0}, \dots, {x_n\over 1+x_0})\]
    then the default smooth structure on $M$ is the one defined by atlas $\{i_0, i_1\}$.
    \item Let $\mathbb{RP}^n$ be the $n$-dimensional {\bf real projective space}, let $U_k$, $k=0, \dots, n$ be $U_k=\{[x_0, \dots, x_n]: x_k\not=0\}$, $i_k: U_k\rightarrow \mathbb{R}^n$ be $i_k([x_0, \dots, x_n])=(x_0/x_k,\dots, x_{k-1}/x_k, x_{k+1}/x_k, \dots, x_n/x_k)$. The default smooth structure on $\mathbb{RP}^n$ is the one defined by $\{i_k\}$. Similarly one can define the default smooth structure on the {\bf complex projective space} $\mathbb{CP}^n$.
\end{itemize}
\end{exm}

\begin{dfn}
\begin{enumerate}
\item A real valued function $f$ on a smooth manifold $M$ is called {\bf smooth}, if for any coordinate chart $i: U\rightarrow V$ in the smooth structure of $M$, $f\circ i^{-1}$ is smooth on $V$. A function taking value in $\mathbb{R}^n$ is called smooth if every component of it is smooth.
\item A map between two smooth manifolds $f: M\rightarrow N$ is called {\bf smooth}, if for every $p\in M$, any coordinate chart $i: U\rightarrow V$ in the smooth structure of $M$ such that the domain contains $p$, any coordinate chart $j: U'\rightarrow V'$ in the smooth structure of $N$ such that the domain contains $f(p)$, there is some neighborhood $V_p$ of $i(p)$ in $V$ such that $f\circ i^{-1}(V_p)\subseteq U'$, and $j\circ f\circ i^{-1}$ is smooth on $V_p$.
\item A bijection between two smooth manifolds which is smooth, and has smooth inverse, is called a {\bf diffeomorphism}. 
\end{enumerate}
\end{dfn}

\begin{rmk}
    It is easy to see that to check a function is smooth or a map is smooth, one need to only verify it for an atlas of the domain.
\end{rmk}

\begin{dfn}
\begin{itemize}
   \item If $M$ is a smooth manifold and $U\subseteq M$ an open subset, $U$ can be made into a smooth manifold by restricting the coordinate charts of $M$ to $U$, and $U$ is called an {\bf open submanifold}.
   \item Let $M$ and $N$ be two smooth manifolds, of dimensions $m$ and $n$ respectively. Let $A$ be a smooth atlas on $M$, $B$ a smooth atlas on $N$, both subsets of the respective smooth structure, then 
    \[A\times B=\{(p, q)\mapsto (i(p), j(q)): i\in A, j\in B\}\]
    is a smooth atlas on $M\times N$. We call $M\times N$ with the induced smooth structure the {\bf product manifold}. 
    \end{itemize}
\end{dfn}

\begin{dfn}
    A group $G$ is called a {\bf Lie group}, if it is also a smooth manifold and the multiplication and inverse functions are both smooth.
\end{dfn}

\begin{exm}
    Consider the {\bf general linear group} $GL(n, \mathbb{R})$, which we see as an open subset of $\mathbb{R}^{n\times n}$. Linear algebra implies that it is a Lie group.
\end{exm}

Another way of constructing smooth manifolds is by ``patching'' together locally Euclidean pieces. Namely:

\begin{thm}
    If $M$ is a set, $\{U_\alpha\}$ a set of subsets of $M$, $\bigcup_\alpha U_\alpha=M$. For every $U_\alpha$, there is a bijection $i_\alpha$ from $U_\alpha$ to an open subset of $\mathbb{R}^d$, denoted as $V_\alpha$. If
    \begin{enumerate}[(1)]
        \item If $U_a\cap U_b\not=\emptyset$, then $i_a(U_a\cap U_b)$ is an open subset of $V_a$.
        \item If $U_a\cap U_b\not=\emptyset$, then $i_bi_a^{-1}: i_a(U_a\cap U_b)\rightarrow i_b(U_a\cap U_b)$ is smooth.
        \item There is a countable subset of $\{U_\alpha\}$ whose union is $M$.
        \item If $p, q\in M$, either there is some $U_a$ containing both $p$ and $q$, or there are $U_a$, $U_b$ such that $p\in U_a$, $q\in U_b$ and $U_a\cap U_b=\emptyset$.
    \end{enumerate}
    Then:
    \begin{enumerate}
        \item $M$ is a topological manifold under the topology 
        \[O=\{U\subseteq M: i_\alpha(U\cap U_\alpha)\text{ is open in }V_\alpha\text{ for all }\alpha\}\]
        \item $\{i_\alpha\}$ is a smooth atlas on $M$, which makes it a smooth manifold.
    \end{enumerate}
\end{thm}

\begin{proof}
     It is clear that $O$ is a topology. Condition (1) implies that all $U_\alpha$ are open in this topology, hence $\{U_\alpha\}$ is an open cover of $M$. Condition (2) implies that $i_b\circ i_a^{-1}$ are all homeomorphisms, which together with Condition (1), implies that for any open subset $V\subseteq V_\alpha$, $i_\alpha^{-1}(V)$ is open in $M$, which implies that $i_\alpha$ are all homeomorphisms, i.e. the topology on $M$ is locally Euclidean. This together with Condition (4) implies that the topology on $M$ is Hausdorff, and together with the condition (3) implies that the topology is second countable. This proved part 1. Now Part 2 follows immediately from Condition (2).
\end{proof}

\newpage

\section{Partition of Unity and smooth approximation of functions}

\begin{dfn}
Let $X$ be a topological space, $f$ a real valued function. The {\bf support} of $f$, denoted as $supp(f)$, is defined as $\overline{\{x\in X: f(x)\not=0\}}$.
\end{dfn}

\begin{lem}\label{lem1pu}
Let $M$ be a smooth manifold, $i: U\rightarrow V$ a coordinate chart in the smooth structure. Let $f$ be a compactly supported smooth function on $V$, then $f': M\rightarrow\mathbb{R}$ defined as 
\[f'(p)=\begin{cases} f(i(p)) & p\in U\\ 0 & p\not\in U\end{cases}\]
is smooth on $M$.
\end{lem}

\begin{proof}
    Let $i': U'\rightarrow V'$ be another coordinate chart in the smooth structure of $M$, and $q\in V'$. If $i'{-1}(q)\in U$, in a neighborhood of $q$ we have $f'\circ i'^{-1}=f\circ i\circ i'^{-1}$ hence is smooth. If not, by Lemma \ref{lem1para} there must be a neighborhood of $i'^{-1}(q)$ in $M$ which is disjoint from the support of $f'$, hence in a neighborhood of $q$ the function $f'\circ i'^{-1}=0$.
\end{proof}

\begin{lem}\label{lem2pu}
    Let $U$ be an open subset of $\mathbb{R}^n$, $V\subseteq U$ a bounded closed set. Then there is a smooth function $g$ on $\mathbb{R}^n$ such that $V\subseteq supp(g)\subseteq U$. 
\end{lem}

\begin{proof}
    Pick $\epsilon>0$ small enough such that the closure of the $\epsilon$-neighborhood of $V$ is contained in $U$. Let 
    \[g'(x)=\begin{cases}1 & x\in V\\ {\epsilon-2dist(x, V)\over \epsilon} & 0<dist(x, V)<\epsilon/2 \\ 0 & dist(x, v) \geq \epsilon/2\end{cases}\]
    Then we can let $g=g'*\phi$, where $\phi$ is a {\bf smooth bump function}:
    \[\phi(x_1, \dots, x_n)=\begin{cases}e^{-1/(\epsilon^2/4-\sum_i x_i^2)} & \sum_i x_i^2<\epsilon^2/4 \\ 0 & \sum_i x_i^2\geq \epsilon^2/4\end{cases}\]
\end{proof}

This is a stronger version of Lemma \ref{lem2para}:

\begin{lem}\label{lem3pu}
    Let $M$ be a smooth manifold, $\mathcal{C}$ an open cover. There is a countable refinement of $\mathcal{C}$, denoted as $\mathcal{D}$, such that each element in $\mathcal{D}$ is the domain of a coordinate chart of $M$ in its smooth structure, is homeomorphic to an open disc, and its closure is homeomorphic to a closed disc. 
\end{lem}

\begin{proof}
 The proof is almost identical to Lemma \ref{lem2para}. Only differences are that the homeomorphism $i_p$ are required to be in the smooth structure of $M$, and also the neighbors $B_p$ have to be sufficiently small so they are subsets of some element of $\mathcal{C}$.
\end{proof}

\begin{lem}\label{lem4pu}
    Let $X$ be a topological space, $\mathcal{C}$ a locally finite cover of $X$, $A\subseteq X$ compact. Then there is an open set $U\subseteq X$, such that $X\subseteq U$ and $U$ intersects with only finitely many elements of $\mathcal{C}$.
\end{lem}

\begin{proof}
    For every $x\in X$, let $U_x$ be a neighborhood such that there are only finitely many elements in $\mathcal{C}$ that have non-empty intersection with $U_x$. Compactness implies that there are finitely many points $x_1, \dots, x_n$ such that $X=\bigcup_{i=1}^n U_{x_i}$, and we can let $U=\bigcup_{i=1}^n U_{x_i}$.
\end{proof}

\begin{lem}\label{lem5pu}
    Let $X$ be a hausdorff topological space, $\mathcal{C}$ a locally finite cover of $X$ such that the closure of all elements of $\mathcal{C}$ are compact. Then there is a locally finite cover $\mathcal{C}'$ and a surjection $i: \mathcal{C}\rightarrow \mathcal{C}'$, such that for any $U\in \mathcal{C}$, $U\subseteq i(U)$.
\end{lem}

\begin{proof}
    For any $U\in \mathcal{C}$, by Lemma \ref{lem4pu}, there are finitely many elements in $\mathcal{C}$ that have non-empty intersection with $\overline{U}$. Let $i(U)$ be their union. To show that $\{ i(U): U\in\mathcal{C}\}$ is locally finite, for any $p\in X$, let $U$ be an element of $\mathcal{C}$ that contains $p$. Then $U\cap i(V)\not=\emptyset$ iff there is some $W\in\mathcal{C}$ such that $U\cap W\not=\emptyset$, $W\cap V\not=\emptyset$. It is easy to see that there are only finitely many such $V$.
\end{proof}

We will now prove the main theorem:

\begin{thm}\label{pu}
Let $M$ be a smooth manifold, $\mathcal{C}$ an open cover. Then:
\begin{enumerate}
    \item There is a countable, locally finite refinement $\mathcal{C}'$ of $\mathcal{C}$, such that for every $D\in \mathcal{C}'$ there is a non-negative smooth function $f_D$ with compact support containing in $D$, and $1=\sum_D f_D$.
    \item For every $U\in\mathcal{C}$, there is a non-negative smooth function $f_U$ whose support is in $U$, such that $1=\sum_U f_U$. Here the right hand side always have finitely many non-zero terms.
\end{enumerate}
\end{thm}


\begin{proof}
    Apply Theorem \ref{para} to the $\mathcal{D}$ from Lemma \ref{lem3pu}, we get a locally finite refinement denoted as $\mathcal{C}''$. Apply Lemma \ref{lem5pu}, shrinking the resulting open sets if necessary so that their closures are in a coordinate chart in the smooth structure of $M$, we get the locally finite cover $\mathcal{C}'$ and surjection $I: \mathcal{C}''\rightarrow \mathcal{C}'$. For every $V\in\mathcal{C}''$, apply Lemma \ref{lem2pu} to the image of $V$ and $I(V)$ under the coordinate chart, then by Lemma \ref{lem1pu} one can get a smooth non-negative function $f_V$ whose support contains $\overline{V}$ and is contained in $I(V)$. Then 
    \[f_D={\sum_{W\in\mathcal{C}'', I(W)=D}f_W\over\sum_{V\in\mathcal{C}''}f_V}\]
    To show part 2, for every $D\in\mathcal{C}'$, pick some $U_D\in \mathcal{C}$ such that $D\subseteq U_D$, and let $f_U=\sum_{U_D=U}f_D$. 
\end{proof}

As an application, we have the following results:

\begin{lem}[Smooth Extension Lemma]\label{extend}
Let $M$ be a smooth manifold, $A\subseteq M$ a closed set. Let $f$ be a real valued function on $A$, such that for every $p\in A$, there is some open set $U_p$ containing $p$, some real valued function $f_p$ which is smooth on $U_p$ and $f_p|_{A\cap U_p}=f|_{A\cap U_p}$. Then there is a smooth function $g$ on $M$ such that $f|A=g|A$. 
\end{lem}

\begin{proof}
Consider the open cover of $M$: $\mathcal{C}=\{U_p: p\in A\}\cup\{M\backslash A\}$. Apply Lemma \ref{lem3pu} to get $\mathcal{D}$, then Part 1 of Theorem \ref{pu} to get $\mathcal{D}'$ with partition of unity functions $\{f_D: D\in\mathcal{D}'\}$. Now for every $D\in\mathcal{D}'$, if $D\subseteq U_p$ for some $p$, pick one such $p$ and set $g_D=f_Df_p$, otherwise let $g_D=0$. Then $g=\sum_{D\in\mathcal{D}'}g_D$ is the required smooth function.
\end{proof}

\begin{rmk}
    If $f$ satisfies the assumptions of Lemma \ref{extend}, we say $f$ is {\bf smooth on $A$}.
\end{rmk}

\begin{thm}[First Smooth Approximation for Functions]\label{approx1}
Let $M$ be a smooth manifold, $f$ a continuous, real valued function on $M$, and let $\epsilon$ be any positive real number. Then there is a smooth function $g$ on $M$ such that $|f-g|\leq \epsilon$.
\end{thm}

\begin{proof} Let $\mathcal{D}$ be the open cover from Lemma \ref{lem3pu}, apply Theorem \ref{pu} part 1 we get a countable, locally finite refinement $\mathcal{D}'$ and a set of compactly supported smooth functions $\{f_D: D\in \mathcal{D}'\}$. Now every $D\in\mathcal{D}'$ lies in some $U\in\mathcal{D}$. Let $i_U$ be the corresponding smooth coordinate chart, and $i_D=i_U|_D$. Then $(ff_D)\circ i_D^{-1}$ is a continuous function with compact support, and the support is contained in open set $i_D(D)\subseteq \mathbb{R}^n$.\\

Because $\overline{D}$ is compact, the cardinality of the set $\{D'\in\mathcal{D}': \overline{D}\cap\overline{D}'\not=\emptyset\}$ is finite. Let $N_D\in\mathbb{Z}_{>0}$ be this cardinality. By convolution with a smooth bump function, we can find a smooth function $h_D$ on $\mathbb{R}^n$ with compact support contained in $i_D(D)$ such that $|h_D-(ff_D)\circ i_D^{-1}|<{\epsilon\over 2N_D}$. Now let $g=\sum_{D\in\mathcal{D}'}(h_D\circ i_D)$.
\end{proof}


\begin{thm}[Second Smooth Approximation for Functions]\label{approx2}
Let $M$ be a smooth manifold, $f$ a continuous, real valued function on $M$, which is smooth on closed set $A$. Let $\epsilon$ be any positive real number. Then there is a smooth function $g$ on $M$ such that $|f-g|\leq \epsilon$, and $f=g$ on $A$.
\end{thm}

\begin{proof}
    Let $h$ be the smooth extension of $f|_A$ in Lemma \ref{extend}. $U_A$ be a neighborhood of $A$ on which $|f-h|<\epsilon/2$. Then $\{U_A, M\backslash A\}$ is an open cover of $M$, apply Lemma \ref{lem3pu} to get a refinement $\mathcal{D}$, and continue as in Theorem \ref{approx1}, with the only modification being that if $D\in\mathcal{D}'$ is a subset of $U_A$ then $h_D=(hf_D)\circ i_D^{-1}$.
\end{proof}

\begin{rmk}
    The $\epsilon$ in Theorem \ref{approx1} and Theorem \ref{approx2} can be replaced by positive, continuous functions (in Theorem \ref{approx1}) or non negative continuous functions whose zeros are all in $A$ (in Theorem \ref{approx2}).
\end{rmk}

\section{Rank Theorem, Embedded submanifolds}

\section{Manifolds with Boundary}

\appendix

\section{Practice Problems}

\subsection{Week 1}

1. Show that any topological manifold is metrizable (the topology can be induced by a metric).\\

Answer: Let $C=\{U_i\}$ be a countable cover of this manifold $M$, such that each $U_i$ is homeomorphic to an open disc, and $\overline{U_i}$ is homeomorphic to a closed disc. Glue $M\backslash U_i$ into one point we get a sphere, hence we have homeomorphisms from $M/(M\backslash U_i)$ to the unit sphere $S^n$. Denote $\pi_i: M\rightarrow S^n$ be the composition between this homeomorphism with the quotient map. Let $d_n$ be the Euclidean metric on $S^n$, then we can write down a metric on $M$ as 
\[d(p, q)=\sum_i 2^{-i}d_i(\pi_i(p), \pi_i(q))\]

2. Let $M=(\mathbb{R}^2\times\mathbb{R}^2)/\sim$, where $(a, b)\sim (c, d)$ iff $a=c$, $b=d$ or $a=d$, $b=c$, gives $\mathbb{R}^2\times\mathbb{R}^2$ the product topology and $M$ the quotient topology. Show that $M$ is a topological manifold.\\

Answer: Identify $\mathbb{R}^2$ with $\mathbb{C}$, then the map $\mathbb{C}^2\rightarrow \mathbb{C}^2$ defined as $(z, z')\mapsto (z+z', zz')$ gives a homeomorphism from $M$ to $\mathbb{C}^2$.

\subsection{Week 2}

1. Let $A$, $B$ be two disjoint non-empty compact sets in $\mathbb{R}^n$. Show that there is a smooth function $f$ on $\mathbb{R}^n$, such that $0\leq f\leq 1$, and $f|_A=0, f|_B=1$. (Hint: you can first get a continuous function then smoothen it via convolution.)\\

2. Let $M$ be the set of $2$ dimensional sub spaces of the $4$ dimensional real vector space $\mathbb{R}^4$. Pick any 2-dimensional subspace $H$, identify it with $\mathbb{R}^2$ via a linear bijection $\phi_H: H\rightarrow \mathbb{R}^2$, and two vectors $u$ and $v$ in $\mathbb{R}^4\backslash H$ which are linearly independent, and $u, v, H$ together span $\mathbb{R}^4$. Let 
\[U_{u, v, H}=\{W\in M: \text{ there exist }a_W, b_W\in H, W\cap (u+H)=\{u+a_W\},\]
\[W\cap (v+H)=\{v+b_W\}\}\]
Let 
\[i_{u, v, H}: U_{u, v, H}\rightarrow \mathbb{R}^2\times \mathbb{R}^2\cong\mathbb{R}^4\]
and be defined as 
\[i_{u, v, H}(W)=(\phi_H(a_W), \phi_H(b_W))\]
such that
\[W\cap (u+H)=\{u+a_W\}, W\cap (v+H)=\{v+b_W\}\]
Show that $M$ has a smooth manifold structure such that $\{i_{u, v, H}\}$ is a smooth atlas. This smooth manifold M is called the Grassmannian $Gr_2(\mathbb{R}^4)$.

\section{Notes on Projective Spaces}



\end{document}

